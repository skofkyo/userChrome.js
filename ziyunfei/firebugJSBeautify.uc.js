location=="chrome://browser/content/browser.xul"&&(function(){var d=(document.querySelector("#fbPanelBar1-Arrowscrollbox")||document.querySelector("#fbMainContainer").contentDocument.querySelector("#fbPanelBar1-Arrowscrollbox"));var e=d.parentNode.insertBefore(document.createElement("button"),d.nextElementSibling);e.label="\u683C\u5F0F\u5316\u4EE3\u7801";e.onclick=function(){var a=(document.querySelector("#fbLargeCommandLine")||document.querySelector("#fbMainContainer").contentDocument.querySelector("#fbCommandEditor"));a.value=c(a.value)};var c=function b(aF,aO){var aI,aC,aQ,a6,a,aX,aK,a0,aE,aA;var au,aS,az,aU,aZ,aG;var a8,aN,aw;var a4,aq,an;var at="";aO=aO?aO:{};var a7;if(aO.space_after_anon_function!==undefined&&aO.jslint_happy===undefined){aO.jslint_happy=aO.space_after_anon_function}if(aO.braces_on_own_line!==undefined){a7=aO.braces_on_own_line?"expand":"collapse"}a7=aO.brace_style?aO.brace_style:(a7?a7:"collapse");var bf=aO.indent_size?aO.indent_size:4;var ao=aO.indent_char?aO.indent_char:" ";var t=typeof aO.preserve_newlines==="undefined"?true:aO.preserve_newlines;var aW=typeof aO.max_preserve_newlines==="undefined"?false:aO.max_preserve_newlines;var a1=aO.jslint_happy==="undefined"?false:aO.jslint_happy;var i=typeof aO.keep_array_indentation==="undefined"?false:aO.keep_array_indentation;var ar=typeof aO.space_before_conditional==="undefined"?true:aO.space_before_conditional;var am=typeof aO.indent_case==="undefined"?false:aO.indent_case;aq=false;var aY=aF.length;function a2(f){f=typeof f==="undefined"?false:f;while(aC.length&&(aC[aC.length-1]===" "||aC[aC.length-1]===aA||aC[aC.length-1]===at||(f&&(aC[aC.length-1]==="\n"||aC[aC.length-1]==="\r")))){aC.pop()}}function aM(f){return f.replace(/^\s\s*|\s\s*$/,"")}function aH(h){h=h.replace(/\x0d/g,"");var g=[],f=h.indexOf("\n");while(f!=-1){g.push(h.substring(0,f));h=h.substring(f+1);f=h.indexOf("\n")}if(h.length){g.push(h)}return g}function ap(){var f=i;i=false;aD();i=f}function aD(g){a0.eat_next_space=false;if(i&&bb(a0.mode)){return}g=typeof g==="undefined"?true:g;a0.if_line=false;a2();if(!aC.length){return}if(aC[aC.length-1]!=="\n"||!g){aq=true;aC.push("\n")}if(at){aC.push(at)}for(var f=0;f<a0.indentation_level;f+=1){aC.push(aA)}if(a0.var_line&&a0.var_line_reindented){aC.push(aA)}if(a0.case_body){aC.push(aA)}}function aP(){if(a6==="TK_COMMENT"){return aD(true)}if(a0.eat_next_space){a0.eat_next_space=false;return}var f=" ";if(aC.length){f=aC[aC.length-1]}if(f!==" "&&f!=="\n"&&f!==aA){aC.push(" ")}}function bg(){aq=false;a0.eat_next_space=false;aC.push(aQ)}function aR(){a0.indentation_level+=1}function a9(){if(aC.length&&aC[aC.length-1]===aA){aC.pop()}}function aV(f){if(a0){aE.push(a0)}a0={previous_mode:a0?a0.mode:"BLOCK",mode:f,var_line:false,var_line_tainted:false,var_line_reindented:false,in_html_comment:false,if_line:false,in_case_statement:false,in_case:false,case_body:false,eat_next_space:false,indentation_baseline:-1,indentation_level:(a0?a0.indentation_level+(a0.case_body?1:0)+((a0.var_line&&a0.var_line_reindented)?1:0):0),ternary_depth:0}}function bb(f){return f==="[EXPRESSION]"||f==="[INDENTED-EXPRESSION]"}function ay(f){return be(f,["[EXPRESSION]","(EXPRESSION)","(FOR-EXPRESSION)","(COND-EXPRESSION)"])}function aB(){aw=a0.mode==="DO_BLOCK";if(aE.length>0){var f=a0.mode;a0=aE.pop();a0.previous_mode=f}}function av(j,g){for(var h=0;h<j.length;h++){var f=aM(j[h]);if(f.charAt(0)!==g){return false}}return true}function bc(f){return be(f,["case","return","do","if","throw","else"])}function be(g,f){for(var h=0;h<f.length;h+=1){if(f[h]===g){return true}}return false}function a5(g){var f=aU;var h=aI.charAt(f);while(be(h,au)&&h!=g){f++;if(f>=aY){return 0}h=aI.charAt(f)}return h}function aT(){an=0;if(aU>=aY){return["","TK_EOF"]}a4=false;var k=aI.charAt(aU);aU+=1;var h=i&&bb(a0.mode);if(h){var r=0;while(be(k,au)){if(k==="\n"){a2();aC.push("\n");aq=true;r=0}else{if(k==="\t"){r+=4}else{if(k==="\r"){}else{r+=1}}}if(aU>=aY){return["","TK_EOF"]}k=aI.charAt(aU);aU+=1}if(a0.indentation_baseline===-1){a0.indentation_baseline=r}if(aq){var p;for(p=0;p<a0.indentation_level+1;p+=1){aC.push(aA)}if(a0.indentation_baseline!==-1){for(p=0;p<r-a0.indentation_baseline;p++){aC.push(" ")}}}}else{while(be(k,au)){if(k==="\n"){an+=((aW)?(an<=aW)?1:0:1)}if(aU>=aY){return["","TK_EOF"]}k=aI.charAt(aU);aU+=1}if(t){if(an>1){for(p=0;p<an;p+=1){aD(p===0);aq=true}}}a4=an>0}if(be(k,aS)){if(aU<aY){while(be(aI.charAt(aU),aS)){k+=aI.charAt(aU);aU+=1;if(aU===aY){break}}}if(aU!==aY&&k.match(/^[0-9]+[Ee]$/)&&(aI.charAt(aU)==="-"||aI.charAt(aU)==="+")){var s=aI.charAt(aU);aU+=1;var g=aT(aU);k+=s+g[0];return[k,"TK_WORD"]}if(k==="in"){return[k,"TK_OPERATOR"]}if(a4&&a6!=="TK_OPERATOR"&&a6!=="TK_EQUALS"&&!a0.if_line&&(t||a!=="var")){aD()}return[k,"TK_WORD"]}if(k==="("||k==="["){return[k,"TK_START_EXPR"]}if(k===")"||k==="]"){return[k,"TK_END_EXPR"]}if(k==="{"){return[k,"TK_START_BLOCK"]}if(k==="}"){return[k,"TK_END_BLOCK"]}if(k===";"){return[k,"TK_SEMICOLON"]}if(k==="/"){var n="";var j=true;if(aI.charAt(aU)==="*"){aU+=1;if(aU<aY){while(aU<aY&&!(aI.charAt(aU)==="*"&&aI.charAt(aU+1)&&aI.charAt(aU+1)==="/")){k=aI.charAt(aU);n+=k;if(k==="\n"||k==="\r"){j=false}aU+=1;if(aU>=aY){break}}}aU+=2;if(j&&an==0){return["/*"+n+"*/","TK_INLINE_COMMENT"]}else{return["/*"+n+"*/","TK_BLOCK_COMMENT"]}}if(aI.charAt(aU)==="/"){n=k;while(aI.charAt(aU)!=="\r"&&aI.charAt(aU)!=="\n"){n+=aI.charAt(aU);aU+=1;if(aU>=aY){break}}aU+=1;if(a4){aD()}return[n,"TK_COMMENT"]}}if(k==="'"||k==='"'||(k==="/"&&((a6==="TK_WORD"&&bc(a))||(a===")"&&be(a0.previous_mode,["(COND-EXPRESSION)","(FOR-EXPRESSION)"]))||(a6==="TK_COMMENT"||a6==="TK_START_EXPR"||a6==="TK_START_BLOCK"||a6==="TK_END_BLOCK"||a6==="TK_OPERATOR"||a6==="TK_EQUALS"||a6==="TK_EOF"||a6==="TK_SEMICOLON")))){var f=k;var l=false;var o=k;if(aU<aY){if(f==="/"){var m=false;while(l||m||aI.charAt(aU)!==f){o+=aI.charAt(aU);if(!l){l=aI.charAt(aU)==="\\";if(aI.charAt(aU)==="["){m=true}else{if(aI.charAt(aU)==="]"){m=false}}}else{l=false}aU+=1;if(aU>=aY){return[o,"TK_STRING"]}}}else{while(l||aI.charAt(aU)!==f){o+=aI.charAt(aU);if(!l){l=aI.charAt(aU)==="\\"}else{l=false}aU+=1;if(aU>=aY){return[o,"TK_STRING"]}}}}aU+=1;o+=f;if(f==="/"){while(aU<aY&&be(aI.charAt(aU),aS)){o+=aI.charAt(aU);aU+=1}}return[o,"TK_STRING"]}if(k==="#"){if(aC.length===0&&aI.charAt(aU)==="!"){o=k;while(aU<aY&&k!="\n"){k=aI.charAt(aU);o+=k;aU+=1}aC.push(aM(o)+"\n");aD();return aT()}var q="#";if(aU<aY&&be(aI.charAt(aU),aG)){do{k=aI.charAt(aU);q+=k;aU+=1}while(aU<aY&&k!=="#"&&k!=="=");if(k==="#"){}else{if(aI.charAt(aU)==="["&&aI.charAt(aU+1)==="]"){q+="[]";aU+=2}else{if(aI.charAt(aU)==="{"&&aI.charAt(aU+1)==="}"){q+="{}";aU+=2}}}return[q,"TK_WORD"]}}if(k==="<"&&aI.substring(aU-1,aU+3)==="<!--"){aU+=3;k="<!--";while(aI.charAt(aU)!="\n"&&aU<aY){k+=aI.charAt(aU);aU++}a0.in_html_comment=true;return[k,"TK_COMMENT"]}if(k==="-"&&a0.in_html_comment&&aI.substring(aU-1,aU+2)==="-->"){a0.in_html_comment=false;aU+=2;if(a4){aD()}return["-->","TK_COMMENT"]}if(be(k,az)){while(aU<aY&&be(k+aI.charAt(aU),az)){k+=aI.charAt(aU);aU+=1;if(aU>=aY){break}}if(k==="="){return[k,"TK_EQUALS"]}else{return[k,"TK_OPERATOR"]}}return[k,"TK_UNKNOWN"]}aA="";while(bf>0){aA+=ao;bf-=1}while(aF&&(aF.charAt(0)===" "||aF.charAt(0)==="\t")){at+=aF.charAt(0);aF=aF.substring(1)}aI=aF;aK="";a6="TK_START_EXPR";a="";aX="";aC=[];aw=false;au="\n\r\t ".split("");aS="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_$".split("");aG="0123456789".split("");az="+ - * / % & ++ -- = += -= *= /= %= == === != !== > < >= <= >> << >>> >>>= >>= <<= && &= | || ! !! , : ? ^ ^= |= ::";az+=" <%= <% %> <?= <? ?>";az=az.split(" ");aZ="continue,try,throw,return,var,if,switch,case,default,for,while,break,function".split(",");aE=[];aV("BLOCK");aU=0;while(true){var a3=aT(aU);aQ=a3[0];aN=a3[1];if(aN==="TK_EOF"){break}switch(aN){case"TK_START_EXPR":if(aQ==="["){if(a6==="TK_WORD"||a===")"){if(be(a,aZ)){aP()}aV("(EXPRESSION)");bg();break}if(a0.mode==="[EXPRESSION]"||a0.mode==="[INDENTED-EXPRESSION]"){if(aX==="]"&&a===","){if(a0.mode==="[EXPRESSION]"){a0.mode="[INDENTED-EXPRESSION]";if(!i){aR()}}aV("[EXPRESSION]");if(!i){aD()}}else{if(a==="["){if(a0.mode==="[EXPRESSION]"){a0.mode="[INDENTED-EXPRESSION]";if(!i){aR()}}aV("[EXPRESSION]");if(!i){aD()}}else{aV("[EXPRESSION]")}}}else{aV("[EXPRESSION]")}}else{if(aK==="for"){aV("(FOR-EXPRESSION)")}else{if(be(aK,["if","while"])){aV("(COND-EXPRESSION)")}else{aV("(EXPRESSION)")}}}if(a===";"||a6==="TK_START_BLOCK"){aD()}else{if(a6==="TK_END_EXPR"||a6==="TK_START_EXPR"||a6==="TK_END_BLOCK"||a==="."){if(a4){aD()}}else{if(a6!=="TK_WORD"&&a6!=="TK_OPERATOR"){aP()}else{if(aK==="function"||aK==="typeof"){if(a1){aP()}}else{if(be(a,aZ)||a==="catch"){if(ar){aP()}}}}}}bg();break;case"TK_END_EXPR":if(aQ==="]"){if(i){if(a==="}"){a9();bg();aB();break}}else{if(a0.mode==="[INDENTED-EXPRESSION]"){if(a==="]"){aB();aD();bg();break}}}}aB();bg();break;case"TK_START_BLOCK":if(aK==="do"){aV("DO_BLOCK")}else{aV("BLOCK")}if(a7=="expand"||a7=="expand-strict"){var ax=false;if(a7=="expand-strict"){ax=(a5()=="}");if(!ax){aD(true)}}else{if(a6!=="TK_OPERATOR"){if(a==="="||(bc(a)&&a!=="else")){aP()}else{aD(true)}}}bg();if(!ax){aR()}}else{if(a6!=="TK_OPERATOR"&&a6!=="TK_START_EXPR"){if(a6==="TK_START_BLOCK"){aD()}else{aP()}}else{if(bb(a0.previous_mode)&&a===","){if(aX==="}"){aP()}else{aD()}}}aR();bg()}break;case"TK_END_BLOCK":aB();if(a7=="expand"||a7=="expand-strict"){if(a!=="{"){aD()}bg()}else{if(a6==="TK_START_BLOCK"){if(aq){a9()}else{a2()}}else{if(bb(a0.mode)&&i){i=false;aD();i=true}else{aD()}}bg()}break;case"TK_WORD":if(aw){aP();bg();aP();aw=false;break}if(aQ==="function"){if(a0.var_line){a0.var_line_reindented=true}if((aq||a===";")&&a!=="{"&&a6!="TK_BLOCK_COMMENT"&&a6!="TK_COMMENT"){an=aq?an:0;if(!t){an=1}for(var aL=0;aL<2-an;aL++){aD(false)}}}if(aQ==="case"||(aQ==="default"&&a0.in_case_statement)){if(a===":"||a0.case_body){a9()}else{if(!am){a0.indentation_level--}aD();if(!am){a0.indentation_level++}}bg();a0.in_case=true;a0.in_case_statement=true;a0.case_body=false;break}a8="NONE";if(a6==="TK_END_BLOCK"){if(!be(aQ.toLowerCase(),["else","catch","finally"])){a8="NEWLINE"}else{if(a7=="expand"||a7=="end-expand"||a7=="expand-strict"){a8="NEWLINE"}else{a8="SPACE";aP()}}}else{if(a6==="TK_SEMICOLON"&&(a0.mode==="BLOCK"||a0.mode==="DO_BLOCK")){a8="NEWLINE"}else{if(a6==="TK_SEMICOLON"&&ay(a0.mode)){a8="SPACE"}else{if(a6==="TK_STRING"){a8="NEWLINE"}else{if(a6==="TK_WORD"){if(a==="else"){a2(true)}a8="SPACE"}else{if(a6==="TK_START_BLOCK"){a8="NEWLINE"}else{if(a6==="TK_END_EXPR"){aP();a8="NEWLINE"}}}}}}}if(be(aQ,aZ)&&a!==")"){if(a=="else"){a8="SPACE"}else{a8="NEWLINE"}if(aQ==="function"&&(a==="get"||a==="set")){a8="SPACE"}}if(a0.if_line&&a6==="TK_END_EXPR"){a0.if_line=false}if(be(aQ.toLowerCase(),["else","catch","finally"])){if(a6!=="TK_END_BLOCK"||a7=="expand"||a7=="end-expand"||a7=="expand-strict"){aD()}else{a2(true);aP()}}else{if(a8==="NEWLINE"){if((a6==="TK_START_EXPR"||a==="="||a===",")&&aQ==="function"){}else{if(aQ==="function"&&a=="new"){aP()}else{if(bc(a)){aP()}else{if(a6!=="TK_END_EXPR"){if((a6!=="TK_START_EXPR"||aQ!=="var")&&a!==":"){if(aQ==="if"&&aK==="else"&&a!=="{"){aP()}else{a0.var_line=false;a0.var_line_reindented=false;aD()}}}else{if(be(aQ,aZ)&&a!=")"){a0.var_line=false;a0.var_line_reindented=false;aD()}}}}}}else{if(bb(a0.mode)&&a===","&&aX==="}"){aD()}else{if(a8==="SPACE"){aP()}}}}bg();aK=aQ;if(aQ==="var"){a0.var_line=true;a0.var_line_reindented=false;a0.var_line_tainted=false}if(aQ==="if"){a0.if_line=true}if(aQ==="else"){a0.if_line=false}break;case"TK_SEMICOLON":bg();a0.var_line=false;a0.var_line_reindented=false;if(a0.mode=="OBJECT"){a0.mode="BLOCK"}break;case"TK_STRING":if(a6==="TK_END_EXPR"&&be(a0.previous_mode,["(COND-EXPRESSION)","(FOR-EXPRESSION)"])){aP()}else{if(a6=="TK_STRING"||a6==="TK_START_BLOCK"||a6==="TK_END_BLOCK"||a6==="TK_SEMICOLON"){aD()}else{if(a6==="TK_WORD"){aP()}}}bg();break;case"TK_EQUALS":if(a0.var_line){a0.var_line_tainted=true}aP();bg();aP();break;case"TK_OPERATOR":var aJ=true;var bh=true;if(a0.var_line&&aQ===","&&(ay(a0.mode))){a0.var_line_tainted=false}if(a0.var_line){if(aQ===","){if(a0.var_line_tainted){bg();a0.var_line_reindented=true;a0.var_line_tainted=false;aD();break}else{a0.var_line_tainted=false}}}if(bc(a)){aP();bg();break}if(aQ=="*"&&a6=="TK_UNKNOWN"&&!aX.match(/^\d+$/)){bg();break}if(aQ===":"&&a0.in_case){if(am){a0.case_body=true}bg();aD();a0.in_case=false;break}if(aQ==="::"){bg();break}if(aQ===","){if(a0.var_line){if(a0.var_line_tainted){bg();aD();a0.var_line_tainted=false}else{bg();aP()}}else{if(a6==="TK_END_BLOCK"&&a0.mode!=="(EXPRESSION)"){bg();if(a0.mode==="OBJECT"&&a==="}"){aD()}else{aP()}}else{if(a0.mode==="OBJECT"){bg();aD()}else{bg();aP()}}}break}else{if(be(aQ,["--","++","!"])||(be(aQ,["-","+"])&&(be(a6,["TK_START_BLOCK","TK_START_EXPR","TK_EQUALS","TK_OPERATOR"])||be(a,aZ)))){aJ=false;bh=false;if(a===";"&&ay(a0.mode)){aJ=true}if(a6==="TK_WORD"&&be(a,aZ)){aJ=true}if(a0.mode==="BLOCK"&&(a==="{"||a===";")){aD()}}else{if(aQ==="."){aJ=false}else{if(aQ===":"){if(a0.ternary_depth==0){if(a0.mode=="BLOCK"){a0.mode="OBJECT"}aJ=false}else{a0.ternary_depth-=1}}else{if(aQ==="?"){a0.ternary_depth+=1}}}}}if(aJ){aP()}bg();if(bh){aP()}if(aQ==="!"){}break;case"TK_BLOCK_COMMENT":var bd=aH(aQ);if(av(bd.slice(1),"*")){aD();aC.push(bd[0]);for(aL=1;aL<bd.length;aL++){aD();aC.push(" ");aC.push(aM(bd[aL]))}}else{if(bd.length>1){aD()}else{if(a6==="TK_END_BLOCK"){aD()}else{aP()}}for(aL=0;aL<bd.length;aL++){aC.push(bd[aL]);aC.push("\n")}}if(a5("\n")!="\n"){aD()}break;case"TK_INLINE_COMMENT":aP();bg();if(ay(a0.mode)){aP()}else{ap()}break;case"TK_COMMENT":if(a6=="TK_COMMENT"){aD();if(a4){aD(false)}}else{if(a4){aD()}else{aP()}}bg();if(a5("\n")!="\n"){ap()}break;case"TK_UNKNOWN":if(bc(a)){aP()}bg();break}aX=a;a6=aN;a=aQ}var ba=at+aC.join("").replace(/[\r\n ]+$/,"");return ba}})();